@version: 3.12
@include "scl.conf"
#
# /etc/syslog-ng/syslog-ng.conf
#

options {
    stats_freq(0);
    flush_lines(0);
    time_reopen(10);
    log_fifo_size(10000);
    chain_hostnames(off);
    use_dns(no);
    use_fqdn(no);
    create_dirs(no);
    keep_hostname(yes);
};

# sources
source s_syslog {
    unix-dgram("/dev/log");
};

# parsers
parser p_pdb_keeto_audit {
    db-parser(
        file("/etc/syslog-ng/patterndb.d/keeto-audit.xml")
    );
};

# filters
filter f_tag_keeto_audit {
    tags("keeto_audit");
};

# destinations
destination d_tcp_keeto_syslog_ng {
    syslog(
        "keeto-syslog-ng",
        transport("tcp"),
        port(601),
    );
};

# log statements
log {
    source(s_syslog);
    parser(p_pdb_keeto_audit);
    filter(f_tag_keeto_audit);
    destination(d_tcp_keeto_syslog_ng);
};

